# All of the following are seeded with defaults in the config
#   user: the current user
#   homedir: the current user's home directory
#   buildroot: the root of this repo
#   pants_bootstrapdir: the global pants scratch space primarily used for caches
#   pants_supportdir: pants support files for this repo go here; for example: ivysettings.xml
#   pants_distdir: user visible artifacts for this repo go here
#   pants_workdir: the scratch space used to for live builds in this repo
#
# NOTE: Values of list and dict type must be valid JSON.

[DEFAULT]
pants_supportdir: pants-support
pants_support_baseurls = [
    "https://dl.bintray.com/pantsbuild/bin/build-support"
  ]

outdir: %(pants_distdir)s

jvm_options: ["-Xmx1g", "-XX:MaxPermSize=256m"]


[ivy]
base_url: https://artifactory.twitter.biz/java-virtual
version: 2.5.0.alpha_20150106181200
bootstrap_jar_url: %(base_url)s/org/apache/ivy/ivy/%(version)s/ivy-%(version)s.jar
bootstrap_fetch_timeout_secs: 30

ivy_settings: %(pants_supportdir)s/ivy/ivysettings.xml
ivy_profile: %(pants_supportdir)s/ivy/ivy.xml
cache_dir: %(homedir)s/.ivy2/limiter/cache


[scrooge-gen]
supportdir: %(pants_supportdir)s/bin/scrooge
strict: False
verbose: True
java: {
    'gen': 'java',
    'deps': {
      'service': [
        '3rdparty/jvm/org/apache/thrift:thrift-0.5.0',
        '3rdparty/jvm/org/scala-lang:scala-library',
        '3rdparty/jvm/org/slf4j:slf4j-api',
        'finagle/finagle-core',
        'finagle/finagle-thrift',
        'scrooge/scrooge-core',
        'util/util-core',
      ],
      'structs': [
        '3rdparty/jvm/org/apache/thrift:thrift-0.5.0',
        'scrooge/scrooge-core',
        'util/util-core'
      ]
    }
  }
scala: {
    'gen': 'scala',
    'deps': {
      'service': [
        '3rdparty/jvm/org/apache/thrift:thrift-0.5.0',
        'finagle/finagle-core',
        'finagle/finagle-thrift',
        'scrooge/scrooge-core',
        'util/util-core'
      ],
      'structs': [
        '3rdparty/jvm/org/apache/thrift:thrift-0.5.0',
        'finagle/finagle-core',
        'scrooge/scrooge-core',
        'util/util-core'
      ]
    }
  }


[thrift-gen]
supportdir: bin/thrift
strict: False
verbose: False
version: 0.5.0-finagle
java: {
    'gen': 'java:hashcode',
    'deps': {
      'service': ['3rdparty:thrift-0.5.0-finagle'],
      'structs': ['3rdparty/jvm/org/apache/thrift:thrift-0.5.0']
    }
  }
python: {
    'gen': 'py:newstyle',
    'deps': {
      'service': ['3rdparty/python:thrift'],
      'structs': ['3rdparty/python:thrift']
    }
  }


[compile.checkstyle]
checkstyle: [':twitter-checkstyle']
configuration: %(pants_supportdir)s/checkstyle/coding_style.xml
properties: {
    'checkstyle.suppression.files': '%(pants_supportdir)s/checkstyle/suppressions.xml'
  }


[scalastyle]
config: %(buildroot)s/build-support/scalastyle/scalastyle_config.xml
excludes: %(buildroot)s/build-support/scalastyle/excludes.txt

[repl.scala]
scala_repl: ["//:scala-repl-2.9.3"]
jvm_options: ["-Xmx1g", "-XX:MaxPermSize=256m", "-Dscala.usejavacp=true" ]

[java-compile]
jvm_args: ['-Xmx3G']

[compile.java]
args: [
    '-C-encoding', '-CUTF-8',
    '-C-g',
    '-C-Tcolor',

    # Suppress the warning for annotations with no processor - we know there are many of these!
    '-C-Tnowarnregex', '-C^(warning: )?No processor claimed any of these annotations: .*'
  ]
warning_args: [
    '-C-Xlint:all', '-C-Xlint:-serial', '-C-Xlint:-path',
    '-C-deprecation',
  ]
no_warning_args: [
    '-C-Xlint:none',
    '-C-nowarn',
  ]

source: 7
target: 7


[scala-compile]
compile-bootstrap-tools: ['3rdparty/jvm/org/scala-lang:scala-compiler']
runtime-deps: ['3rdparty/jvm/org/scala-lang:scala-library']

jvm_args: ['-Xmx4g', '-XX:MaxPermSize=256m']

platform-version: 2.10


[compile.scala]
runtime-deps: ['3rdparty/jvm/org/scala-lang:scala-library']
scalac: [':scala-compile']
zinc: [':zinc']
jvm_options: ["-Xmx2g", "-XX:MaxPermSize=256m", "-Dzinc.analysis.cache.limit=0"]
args: [
    '-C-source', '-C1.7',
    '-C-target', '-C1.7',
    '-S-encoding', '-SUTF-8',
    '-S-g:vars',
    # TODO: added to fix SI-8337 and SI-7291
    '-S-Xdivergence211',
    # see https://reviewboard.twitter.biz/r/446503/
    '-S-language:higherKinds',
  ]
warning_args: [
    '-S-deprecation',
    '-S-unchecked',
    # request warnings for http://www.scala-lang.org/api/2.10.4/index.html#scala.language$
    '-S-feature',
  ]
no_warning_args: [
    '-S-nowarn',
  ]
platform-version: 2.10


[run.jvm]
jvm_options: ["-Xmx1g", "-XX:MaxPermSize=256m"]


[test.junit]
jvm_options: [
    '-Djava.awt.headless=true',
    '-Djava.net.preferIPv4Stack=true',
    '-Xmx2g',
    # TODO: increased to allow macaw-swift tests (which load A LOT of classes) to pass (see CHIP-75)
    '-XX:MaxPermSize=512m',

    # Needed for emma instrumenter to work against classfiles generated by java 7 compilers
    '-XX:-UseSplitVerifier',
  ]


[bench]
jvm_options: ["-Xmx1g", "-XX:MaxPermSize=256m"]


[ide]
workdir: %(pants_workdir)s/ide
classes_conf: default
sources_conf: sources
extra_jvm_source_paths = []
extra_jvm_test_paths = ['tests/resources']
python_source_paths: ['src/python']
python_test_paths: ['tests/python']
# TODO(wickman)  ide-gen will be broken for python until it is integrated into pants.new
# See http://jira.local.twitter.com/browse/AWESOME-1018
python_lib_paths: ['3rdparty/python']


[idea]
scala_maximum_heap_size_mb: 1024
java_maximum_heap_size_mb: 1024


[python-setup]
# We only support pants running under 2.7 for now with 3.3+ support to be added later.
# Any example or test targets that are meant to test interpreters outside pants own
# acceptable set should specify an explicit compatibility constraint.
interpreter_requirement: CPython>=2.7,<3

platforms: [
    'current',
    'linux-x86_64'
  ]


[python-repos]
repos: [
    "https://pantsbuild.github.io/cheeseshop/third_party/python/dist/index.html",
    "https://pantsbuild.github.io/cheeseshop/third_party/python/index.html"
  ]

indices: ["https://pypi.python.org/simple/"]


[python-ipython]
entry_point: IPython:start_ipython
requirements: ["ipython==1.0.0"]


[java-thrift-library]
compiler: scrooge


[backends]
packages: [
    "artifactory",
  ]
